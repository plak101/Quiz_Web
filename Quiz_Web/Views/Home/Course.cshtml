@model List<Quiz_Web.Models.Entities.Course>
@{
	ViewData["Title"] = "Danh sách khóa học";
	Layout = "_Layout";
}

<style>
	.course-card {
		transition: transform 0.3s ease, box-shadow 0.3s ease;
		border: none;
		border-radius: 12px;
		overflow: hidden;
	}

		.course-card:hover {
			transform: translateY(-5px);
			box-shadow: 0 10px 30px rgba(0,0,0,0.15) !important;
		}

	.bg-gradient-primary {
		background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
	}

	.card-title {
		color: #2d3748;
		font-size: 1rem;
		line-height: 1.4;
		min-height: 42px;
	}

	.badge {
		font-weight: 600;
	}

	/* Compact Search Bar Styles */
	.search-wrapper {
		max-width: 600px;
		margin: 0 auto;
	}

	.search-form {
		display: flex;
		gap: 0;
		box-shadow: 0 4px 12px rgba(0,0,0,0.08);
		border-radius: 50px;
		overflow: hidden;
		background: white;
	}

	.search-input {
		flex: 1;
		border: none;
		padding: 14px 24px;
		font-size: 15px;
		outline: none;
	}

		.search-input:focus {
			box-shadow: none;
		}

		.search-input::placeholder {
			color: #999;
		}

	.search-btn {
		background: #0d6efd;
		color: white;
		border: none;
		padding: 14px 32px;
		font-size: 15px;
		font-weight: 600;
		cursor: pointer;
		transition: background 0.3s ease;
		display: flex;
		align-items: center;
		gap: 8px;
		white-space: nowrap;
	}

		.search-btn:hover {
			background: #0b5ed7;
		}

		.search-btn i {
			font-size: 18px;
		}
</style>

@* Compact Search Section *@
<section class="py-4 bg-light">
	<div class="container">
		<div class="search-wrapper">
			<form asp-action="SearchCourses" method="get" class="search-form">
				<input type="text" 
					   name="keyword" 
					   class="search-input" 
					   placeholder="Tìm kiếm khóa học..." 
					   value="@ViewBag.Keyword" />
				<button type="submit" class="search-btn">
					<i class="fas fa-search"></i>
					<span>Tìm</span>
				</button>
			</form>
		</div>
	</div>
</section>

@* Course grid section *@
<section class="py-5">
	<div class="container">
		@if (ViewBag.Keyword != null)
		{
			<div class="mb-4">
				<h4>Kết quả tìm kiếm cho: <strong>@ViewBag.Keyword</strong></h4>
				<p class="text-muted">@Model.Count khóa học được tìm thấy.</p>
			</div>
		}
		else
		{
			<div class="mb-5 text-center">
				<h1>Khám phá khóa học</h1>
				<p class="">Hơn @Model.Count khóa học chất lượng cao đang chờ bạn</p>
			</div>
		}

		@if (Model.Count == 0)
		{
			<div class="text-center py-5">
				<i class="fa-solid fa-box-open fa-5x text-muted mb-3"></i>
				<h3>Không tìm thấy khóa học</h3>
				<p class="text-muted">Vui lòng thử lại với từ khóa khác</p>
				<a asp-action="Course" class="btn btn-primary mt-3">Xem tất cả khóa học</a>
			</div>
		}
		else
		{
			<div class="row g-4">
				@foreach (var course in Model)
				{
					<div class="col-lg-3 col-md-4 col-sm-6">
						<a asp-action="CourseDetail" asp-route-slug="@course.Slug" class="text-decoration-none">
							<div class="card course-card h-100 shadow-sm">
								@* course image *@
								<div class="position-relative">
									@if (!string.IsNullOrEmpty(course.CoverUrl))
									{
										<img src="@course.CoverUrl" class="card-img-top" alt="@course.Title" style="height:180px; object-fit:cover" />
									}
									else
									{
										<div class="bg-gradient-primary d-flex align-items-center justify-content-center" style="height:180px;">
											<i class="fa-solid fa-book fa-3x text-white"></i>
										</div>
									}

									@* menu button *@
									<div class="position-absolute top-0 end-0 m-2">
										<button class="btn btn-light btn-sm rounded-circle" style="width:32px; height:32px;" onclick="event.preventDefault(); event.stopPropagation();">
											<i class="fa-solid fa-ellipsis-vertical"></i>
										</button>
									</div>
								</div>

								@* course content *@
								<div class="card-body d-flex flex-column">
									<h6 class="card-title fw-bold text-truncate text-dark" title="@course.Title">@course.Title</h6>
									<p class="card-text text-muted small mb-2">
										@course.Owner.FullName
									</p>

									@if (!string.IsNullOrEmpty(course.Summary))
									{
										<p class="card-text small text-muted" style="height: 40px; overflow:hidden;">
											@course.Summary
										</p>
									}

									@* course stats *@
									<div class="mb-2">
										<span class="badge bg-warning text-dark me-1">
											<i class="fa-solid fa-star"></i> 4.5
										</span>
										<span class="text-muted small">
											(@course.CoursePurchases.Count đánh giá)
										</span>
									</div>

									@* price * cta *@
									<div class="mt-auto">
										@if (course.Price == 0)
										{
											<span class="badge bg-success mb-2">MIỄN PHÍ</span>
										}
										else
										{
											<div class="d-flex align-items-center justify-content-between mx-2">
												<span class="h5 mb-0 fw-bold text-dark">@course.Price.ToString("N0") ₫</span>
											</div>
										}
									</div>
								</div>
							</div>
						</a>
					</div>
				}
			</div>
		}
	</div>
</section>
